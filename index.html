<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">

<title>í”„ë­í¬ ì˜¤ë²„ë ˆì´</title>

<script src="https://cdn.jsdelivr.net/npm/@rtirl/api"></script>

<style>

body{
margin:0;
background:transparent;
color:white;
font-family:Pretendard;
}


/* ì „ì²´ */

#overlay{

position:fixed;
bottom:10px;
right:20px;

display:flex;
align-items:center;

gap:15px;

background:rgba(0,0,0,0.6);

padding:6px 14px;

border-radius:20px;

}


/* GPS */

#distance{

color:#00ff88;
font-weight:bold;

}


/* ë°°í„°ë¦¬ */

#batteryIcon{

width:26px;
height:13px;

border:2px solid white;

position:relative;

}


#batteryFill{

height:100%;
width:50%;

background:#00ff00;

transition:0.3s;

}


#batteryBolt{

position:absolute;
width:100%;
height:100%;

display:none;

align-items:center;
justify-content:center;

font-size:10px;

}


#batteryCap{

position:absolute;
right:-5px;
top:3px;

width:3px;
height:6px;

background:white;

}


.icon{

height:18px;

}

</style>

</head>
<body>


<div id="overlay">


<div>

<span id="distance">

0.00 km

</span>

</div>


<div id="weather">

ğŸŒ¡ï¸ --

</div>


<div id="time">

ğŸ• --

</div>



<!-- ë°°í„°ë¦¬ -->

<div style="display:flex;align-items:center;gap:5px;">


<div id="batteryIcon">

<div id="batteryFill"></div>

<div id="batteryBolt">âš¡</div>

<div id="batteryCap"></div>

</div>


<div id="batteryText">

--%

</div>


</div>



<div>

<img class="icon"
src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/ìˆ²ë¡œê³ .png">

<img class="icon"
src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/ì¹˜ì§€ì§ë¡œê³ .png">

<img class="icon"
src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/íŠ¸ìœ„ì¹˜ë¡œê³ .png">

<img class="icon"
src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/ìœ íŠœë¸Œë¡œê³ .png">

</div>


</div>



<script type="module">


/* Firebase */

import { initializeApp }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";

import {
getDatabase,
ref,
onValue
}
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";


const firebaseConfig={

apiKey:"AIzaSyA5hMmN9QFgdFtaA5gicS_pj-blu_jJdvE",

authDomain:"rider-bf48b.firebaseapp.com",

databaseURL:"https://rider-bf48b-default-rtdb.firebaseio.com",

projectId:"rider-bf48b",

storageBucket:"rider-bf48b.firebasestorage.app",

messagingSenderId:"1026929653322",

appId:"1:1026929653322:web:b90541cccba5b4186198b3"

};


const app=initializeApp(firebaseConfig);

const db=getDatabase(app);



onValue(
ref(db,"battery"),
snap=>{


if(!snap.exists()) return;

const data=snap.val();

updateBattery(data.level,data.charging);


});



function updateBattery(level,charging){

batteryText.innerText=level+"%";

batteryFill.style.width=level+"%";

batteryFill.style.background=getBatteryColor(level);

batteryBolt.style.display=charging?"flex":"none";

}




/* ìƒ‰ìƒ ë³€ê²½ */

function getBatteryColor(level){


if(level>=90) return "#00ff00";

if(level>=80) return "#33ff00";

if(level>=70) return "#66ff00";

if(level>=60) return "#99ff00";

if(level>=50) return "#ccff00";

if(level>=40) return "#ffff00";

if(level>=30) return "#ffcc00";

if(level>=20) return "#ff9900";

if(level>=10) return "#ff3300";

return "#ff0000";

}




/* GPS */

let totalDistance=0;
let prev=null;


RealtimeIRL
.forPullKey("zeoeyze9htbyx455")
.addLocationListener(loc=>{

if(prev){

totalDistance+=getDistance(
prev.latitude,
prev.longitude,
loc.latitude,
loc.longitude
)/1000;

}

prev=loc;

distance.innerText=
totalDistance.toFixed(2)+" km";

});



function getDistance(lat1,lon1,lat2,lon2){

const R=6371e3;

const Ï†1=lat1*Math.PI/180;
const Ï†2=lat2*Math.PI/180;

const Î”Ï†=(lat2-lat1)*Math.PI/180;
const Î”Î»=(lon2-lon1)*Math.PI/180;

const a=

Math.sin(Î”Ï†/2)**2+

Math.cos(Ï†1)*Math.cos(Ï†2)*

Math.sin(Î”Î»/2)**2;


const c=
2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));

return R*c;

}



/* ì‹œê°„ */

setInterval(()=>{

time.innerText=
"ğŸ• "+new Date().toLocaleTimeString();

},1000);



/* ë‚ ì”¨ */

const WEATHER_API="3a4a39b054762e36581605681026ed35";


async function weatherUpdate(){

const r=await fetch(
"https://api.openweathermap.org/data/2.5/weather?q=Sejong&appid="+WEATHER_API+"&units=metric"
);

const d=await r.json();

document.getElementById("weather").innerText =
"ğŸŒ¡ï¸ "+Math.round(d.main.temp)+"Â°C";

}

weatherUpdate();

setInterval(weatherUpdate,600000);



</script>

</body>
</html>

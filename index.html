<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<title>í”„ë­í¬ ì˜¤ë²„ë ˆì´ (GPS)</title>

<script src="https://cdn.jsdelivr.net/npm/@rtirl/api"></script>

<style>
html, body {
margin: 0;
padding: 0;
overflow: hidden;
font-family: "Pretendard", sans-serif;
background: transparent;
color: white;
}

#overlay {
position: fixed;
bottom: 0;
left: 0;
right: 0;
height: 40px;
background: rgba(0,0,0,0.7);
display: flex;
align-items: center;
justify-content: space-between;
font-size: 14px;
padding: 0 20px;
white-space: nowrap;
}

.left-section,
.right-section {
display: flex;
align-items: center;
gap: 15px;
}

.icon {
height: 20px;
}

#distance {
font-weight: 600;
color: #00ff88;
}

.status-dot {
width: 8px;
height: 8px;
border-radius: 50%;
background: #4CAF50;
margin-right: 5px;
}

.status-dot.connecting {
background: orange;
}

.status-dot.error {
background: red;
}
</style>
</head>

<body>

<div id="overlay">

<div class="left-section">

<div class="section">

<span class="status-dot connecting"></span>

<span id="distance">ì´ë™ê±°ë¦¬: 0.00 km</span>

</div>

</div>


<div class="right-section">

<div id="weather">ğŸŒ¡ï¸ --Â°C</div>

<div id="time">ğŸ• --:--</div>

<div id="battery">ğŸ”‹ --%</div>

<div>

<img class="icon" src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/%EC%88%B2%EB%A1%9C%EA%B3%A0.png">

<img class="icon" src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/%EC%B9%98%EC%A7%80%EC%A7%81%EB%A1%9C%EA%B3%A0.png">

<img class="icon" src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/%ED%8A%B8%EC%9C%84%EC%B9%98%EB%A1%9C%EA%B3%A0.png">

<img class="icon" src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/%EC%9C%A0%ED%8A%9C%EB%B8%8C%EB%A1%9C%EA%B3%A0.png">

</div>

</div>

</div>

<script>

const PULL_KEY = "zeoeyze9htbyx455";
const WEATHER_API = "3a4a39b054762e36581605681026ed35";


let totalDistance = 0;
let previousLocation = null;


RealtimeIRL.forPullKey(PULL_KEY)
.addLocationListener(location => {

if(previousLocation){

const distance = getDistance(

previousLocation.latitude,
previousLocation.longitude,

location.latitude,
location.longitude

);

totalDistance += distance / 1000;

}

previousLocation = location;

document.getElementById("distance").innerText =
"ì´ë™ê±°ë¦¬: " + totalDistance.toFixed(2) + " km";

});


function getDistance(lat1, lon1, lat2, lon2){

const R = 6371e3;

const Ï†1 = lat1 * Math.PI/180;
const Ï†2 = lat2 * Math.PI/180;

const Î”Ï† = (lat2-lat1) * Math.PI/180;
const Î”Î» = (lon2-lon1) * Math.PI/180;

const a =
Math.sin(Î”Ï†/2)*Math.sin(Î”Ï†/2)+
Math.cos(Ï†1)*Math.cos(Ï†2)*
Math.sin(Î”Î»/2)*Math.sin(Î”Î»/2);

const c = 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));

return R*c;

}


async function updateWeather(){

const res =
await fetch(

"https://api.openweathermap.org/data/2.5/weather?q=Sejong,KR&appid="+WEATHER_API+"&units=metric"

);

const data = await res.json();

document.getElementById("weather").innerText =
"ğŸŒ¡ï¸ "+Math.round(data.main.temp)+"Â°C";

}

updateWeather();


setInterval(updateWeather,600000);


setInterval(()=>{

const now = new Date();

document.getElementById("time").innerText =
"ğŸ• "+now.toLocaleTimeString();

},1000);


navigator.getBattery().then(battery=>{

function update(){

document.getElementById("battery").innerText =
"ğŸ”‹ "+Math.round(battery.level*100)+"%";

}

battery.addEventListener("levelchange",update);

update();

});


</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">

<title>í”„ë­í¬ ì˜¤ë²„ë ˆì´</title>

<script src="https://cdn.jsdelivr.net/npm/@rtirl/api"></script>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<style>

html,body{
margin:0;
padding:0;
background:transparent;
font-family:Pretendard;
overflow:hidden;
color:white;
}

#overlay{
position:fixed;
bottom:10px;
right:20px;
display:flex;
align-items:center;
gap:15px;
background:rgba(0,0,0,0.6);
padding:6px 14px;
border-radius:20px;
backdrop-filter:blur(6px);
font-size:14px;
}

#distance{
color:#00ff88;
font-weight:bold;
}

.icon{
height:18px;
}

.status-dot{
width:8px;
height:8px;
border-radius:50%;
background:#00ff88;
margin-right:6px;
display:inline-block;
}

</style>
</head>

<body>

<div id="overlay">

<div>
<span class="status-dot"></span>
<span id="distance">0.00 km</span>
</div>

<div id="weather">ğŸŒ¡ï¸ --</div>

<div id="time">ğŸ• --</div>

<div id="battery">ğŸ”‹ --</div>

<div>

<img class="icon"
src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/%EC%88%B2%EB%A1%9C%EA%B3%A0.png">

<img class="icon"
src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/%EC%B9%98%EC%A7%80%EC%A7%81%EB%A1%9C%EA%B3%A0.png">

<img class="icon"
src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/%ED%8A%B8%EC%9C%84%EC%B9%98%EB%A1%9C%EA%B3%A0.png">

<img class="icon"
src="https://raw.githubusercontent.com/ljw2455qq/obs-overlay/main/%EC%9C%A0%ED%8A%9C%EB%B8%8C%EB%A1%9C%EA%B3%A0.png">

</div>

</div>


<script>


/* Firebase ì„¤ì • */

const firebaseConfig = {

apiKey: "AIzaSyA5hMmN9QFgdFtaA5gicS_pj-blu_jJdvE",

authDomain: "rider-bf48b.firebaseapp.com",

databaseURL: "https://rider-bf48b-default-rtdb.firebaseio.com",

projectId: "rider-bf48b",

storageBucket: "rider-bf48b.firebasestorage.app",

messagingSenderId: "1026929653322",

appId: "1:1026929653322:web:b90541cccba5b4186198b3"

};

firebase.initializeApp(firebaseConfig);

const db = firebase.database();


/* ë°°í„°ë¦¬ ìˆ˜ì‹  */

db.ref("phone/battery").on("value",snap=>{

const data = snap.val();

if(data){

const icon = data.charging ? "âš¡" : "ğŸ”‹";

document.getElementById("battery").innerText =
icon+" "+data.level+"%";

}

});


/* Pull key */

const PULL_KEY="zeoeyze9htbyx455";


let totalDistance=0;
let prev=null;

RealtimeIRL.forPullKey(PULL_KEY).addLocationListener(loc=>{

if(prev){

totalDistance+=

getDistance(

prev.latitude,
prev.longitude,
loc.latitude,
loc.longitude

)/1000;

}

prev=loc;

document.getElementById("distance").innerText=
totalDistance.toFixed(2)+" km";

});


function getDistance(lat1,lon1,lat2,lon2){

const R=6371e3;

const Ï†1=lat1*Math.PI/180;
const Ï†2=lat2*Math.PI/180;

const Î”Ï†=(lat2-lat1)*Math.PI/180;
const Î”Î»=(lon2-lon1)*Math.PI/180;

const a=

Math.sin(Î”Ï†/2)**2+

Math.cos(Ï†1)*Math.cos(Ï†2)*

Math.sin(Î”Î»/2)**2;

const c=

2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));

return R*c;

}


/* ì‹œê°„ */

setInterval(()=>{

document.getElementById("time").innerText=

"ğŸ• "+new Date().toLocaleTimeString();

},1000);


/* ë‚ ì”¨ */

const WEATHER_API="ì—¬ê¸°ì— ë‚ ì”¨ API";

async function weather(){

const r=

await fetch(

"https://api.openweathermap.org/data/2.5/weather?q=Sejong&appid="+WEATHER_API+"&units=metric"

);

const d=await r.json();

document.getElementById("weather").innerText=

"ğŸŒ¡ï¸ "+Math.round(d.main.temp)+"Â°C";

}

weather();

setInterval(weather,600000);


</script>

</body>
</html>

<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>

<body>

<script>

const firebaseConfig = {

  apiKey: "AIzaSyA5hMmN9QFgdFtaA5gicS_pj-blu_jJdvE",

  databaseURL: "https://rider-bf48b-default-rtdb.firebaseio.com"

};

firebase.initializeApp(firebaseConfig);

let battery = null;

async function initBattery() {

  battery = await navigator.getBattery();

  updateBattery();

  battery.onlevelchange = updateBattery;

  battery.onchargingchange = updateBattery;

}

function updateBattery() {

  if (!battery) return;

  const level = Math.floor(battery.level * 100);

  const charging = battery.charging;

  firebase.database().ref("battery").set({

    level: level,

    charging: charging,

    time: Date.now()

  });

  console.log("ì „ì†¡:", level);

}

setInterval(updateBattery, 10000);


// ðŸ”¥ í•µì‹¬: ì ˆì „ëª¨ë“œ ë³µê·€ ê°ì§€

document.addEventListener("visibilitychange", () => {

  if (document.visibilityState === "visible") {

    console.log("ë³µê·€ ê°ì§€ â†’ ìž¬ì´ˆê¸°í™”");

    initBattery();

  }

});

window.addEventListener("pageshow", () => {

  console.log("pageshow â†’ ìž¬ì´ˆê¸°í™”");

  initBattery();

});


// ìµœì´ˆ ì‹¤í–‰

initBattery();

</script>

</body>
</html>
